const canvas=document.querySelector("#canvas"),ctx=canvas.getContext("2d"),score=document.querySelector("#score"),lost=document.querySelector("#lost"),asteroidimg=new Image;asteroidimg.src="img/astero.png";const shipimg=new Image;shipimg.src="img/ship01.png";const fireimg=new Image;fireimg.src="img/fire.png";const boomimage=new Image;boomimage.src="img/expl222.png";const fonimg=new Image;fonimg.src="img/fon.png";let timer=0,count=0,lostCount=0,coordinate=[],shipCoordinate={x:300,y:300},fireCoordinate=[],boomCoordinate=[];boomimage.onload=function(){game()},document.addEventListener("keydown",a=>{let b=a.keyCode;37===b?(shipCoordinate.x-=15,0>=shipCoordinate.x&&(shipCoordinate.x=0)):38===b?(shipCoordinate.y-=15,0>=shipCoordinate.y&&(shipCoordinate.y=0)):39===b?(shipCoordinate.x+=15,550<=shipCoordinate.x&&(shipCoordinate.x=550)):40===b?(shipCoordinate.y+=15,570<=shipCoordinate.y&&(shipCoordinate.y=570)):32===b?(fireCoordinate.push({x:shipCoordinate.x,y:shipCoordinate.y-50,dx:0,dy:-5}),fireCoordinate.push({x:shipCoordinate.x+50,y:shipCoordinate.y-50,dx:0,dy:-3}),fireCoordinate.push({x:shipCoordinate.x-50,y:shipCoordinate.y-50,dx:0,dy:-4})):void 0});const requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,50)}}();function game(){update(),render(),requestAnimationFrame(game)}function update(){for(i in timer++,0==timer%15&&coordinate.push({x:550*Math.random(),y:-50,dx:2*Math.random()-1,dy:2*Math.random()+2,del:0}),boomCoordinate)boomCoordinate[i].animx+=.6,7<boomCoordinate[i].animx&&(boomCoordinate[i].animy++,boomCoordinate[i].animx=0),7<boomCoordinate[i].animy&&boomCoordinate.splice(i,1);for(i in fireCoordinate)fireCoordinate[i].x+=fireCoordinate[i].dx,fireCoordinate[i].y+=fireCoordinate[i].dy,0>fireCoordinate.y&&fireCoordinate.splice(i,1);for(i in coordinate){for(j in coordinate[i].x+=coordinate[i].dx,coordinate[i].y+=coordinate[i].dy,(550<=coordinate[i].x||0>coordinate[i].x)&&(coordinate[i].dx=-coordinate[i].dx),600<=coordinate[i].y&&(lostCount++,coordinate.splice(i,1),lost.innerHTML=lostCount),fireCoordinate)if(50>Math.abs(coordinate[i].x+25-fireCoordinate[j].x-25)&&25>Math.abs(coordinate[i].y-fireCoordinate[j].y)){boomCoordinate.push({x:coordinate[i].x-25,y:coordinate[i].y-25,animx:0,animy:0}),coordinate[i].del=1;break}1==coordinate[i].del&&(count++,coordinate.splice(i,1),score.innerHTML=count)}}function render(){for(i in ctx.drawImage(fonimg,0,0,600,600),ctx.drawImage(shipimg,shipCoordinate.x,shipCoordinate.y),fireCoordinate)ctx.drawImage(fireimg,fireCoordinate[i].x,fireCoordinate[i].y,50,50);for(i in coordinate)ctx.drawImage(asteroidimg,coordinate[i].x,coordinate[i].y,50,50);for(i in boomCoordinate)ctx.drawImage(boomimage,128*Math.floor(boomCoordinate[i].animx),128*Math.floor(boomCoordinate[i].animy),128,128,boomCoordinate[i].x,boomCoordinate[i].y,100,100)}